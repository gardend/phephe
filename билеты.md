# Базы данных
 (^^)/

## 1. Функцианальные зависисмости и нормальные формы

Термины:

**Атрибут** – свойство некоторой сущности. Часто называется полем таблицы.  
**Домен атрибута** – множество допустимых значений, которые может принимать атрибут.  
**Кортеж** – конечное множество взаимосвязанных допустимых значений атрибутов, которые вместе описывают некоторую сущность (строка таблицы).  
**Отношение** — конечное множество кортежей (таблица).  
**Схема отношения** — конечное множество атрибутов, определяющих некоторую сущность. Иными словами, это структура таблицы, состоящей из конкретного набора полей.  
**Проекция** — отношение, полученное из заданного путём удаления и (или) перестановки некоторых атрибутов.

***Функциональная зависимость между атрибутами (множествами атрибутов) X и Y*** означает, что для любого допустимого набора кортежей в данном отношении: если два кортежа совпадают по значению X, то они совпадают по значению Y. 

Пусть задан экземпляр отношения *r(R)*. Пусть *a,b ⊆ R* - множества атрибутов. Экземпляр удовлетворяет функциональной зависимости *a → b*, если для всех пар кортежей *t1* и *t2* выполнено:  
*t1[a] = t2[a] => t1[b] = t2[b]*  
Функциональная зависимость *a → b* выполняется для схемы отношения *r(R)*, если она выполняется для каждой функциональной зависимости.

***Аномалия*** - это такая ситуация в таблице БД, которая приводит к противоречию в БД либо существенноу сложняет обработку БД. (Причина - излишнее дублирование данных в таблице, которое вызывается наличием функциональных зависимостей в таблице)

***Нормальная форма*** - требование, продъявляемое к структуре таблиц в теории реляционных баз данных для устранения из базы избыточных функциональных зависимостей между атрибутами (полями таблиц)

***Первая нормальная форма***:  
Отношение находится в 1НФ, если все его атрибуты являются простыми, все используемые домены должны содержать только скалярные значения. Не должно быть повторений строк в таблице.

***Вторая нормальная форма***:  
Отношение находится в 2НФ, если оно находится в 1НФ, и каждый не ключевой атрибут неприводимо зависит от Первичного ключа. (неприводимость означает, что в составе потенциального ключа отсутствует меньшее подмножество атрибутов, от которого можно также вывести данную функциональную зависимость)

***Третья нормальная форма***:  
Отношение находится в 3НФ, если оно находится в 2НФ, и отсутствуют транзитивные функциональные зависимости неключевых атрибутов от ключевых.

Еще существуют:

***Нормальная форма Бойеса-Кодда (НФБК)***:  
Переменная отношения находится в нормальной форме Бойса — Кодда (иначе — в усиленной третьей нормальной форме) тогда и только тогда, когда каждая её нетривиальная и неприводимая слева функциональная зависимость имеет в качестве своего детерминанта некоторый потенциальный ключ.

***Четвертая нормальная форма***:  
Переменная отношения находится в четвёртой нормальной форме, если она находится в нормальной форме Бойса — Кодда и не содержит нетривиальных многозначных зависимостей.
 
***Пятая нормальная форма***:  
Отношения находятся в 5НФ, если оно находится в 4НФ и отсутствуют сложные зависимые соединения между атрибутами.

***Доменно-ключевая нормальная форма***:  
Переменная отношения находится в ДКНФ тогда и только тогда, когда каждое наложенное на неё ограничение является логическим следствием ограничений доменов и ограничений ключей, наложенных на данную переменную отношения.

***Шестая нормальная форма***:  
Переменная отношения находится в шестой нормальной форме тогда и только тогда, когда она удовлетворяет всем нетривиальным зависимостям соединения.   
Из определения следует, что переменная находится в 6НФ тогда и только тогда, когда она неприводима, то есть не может быть подвергнута дальнейшей декомпозиции без потерь. 


## 2. Семантическая модель Entity-Relationship, E/R-диаграммы

Основными понятиями ER-модели являются *сущность, связь и атрибут*.   

***Сущность*** – это реальный или представляемый объект, информация о котором должна сохраняться и быть доступной. При этом имя сущности – это имя типа, а не некоторого конкретного экземпляра этого типа. 

***Атрибут сущности*** – это любая деталь, которая служит для уточнения, идентификации, классификации, числовой характеристики или выражения состояния сущности.

***Связь*** – это графически изображаемая ассоциация, устанавливаемая между двумя типами сущностей.  
В любой связи выделяются два конца (в соответствии с существующей парой связываемых сущностей), на каждом из которых указываются:  
 -имя конца связи  
 -степень конца связи  
 -обязательность связи

При определении типа сущности необходимо гарантировать, что каждый экземпляр сущности отличим от любого другого экземпляра той же сущности.   
Уникальным идентификатором может быть:  
 -атрибут (или комбинация атрибутов)  
 -связь (или комбинация связей)  
 -комбинация атрибутов и связей

## 3. Проектирование реляционных схем с использованием ER-диаграмм.

## 4. Диаграммы классов языка UML

***UML (Unified Modeling Language)*** является языком объектно-ориентированного моделирования.   
Про сам язык — язык графического описания для объектного моделирования в области разработки программного обеспечения, моделирования бизнес-процессов, системного проектирования и отображения организационных структур.

Язык UML состоит из нескольких подъязыков (они все графические, диаграммные), в число которых входит подъязык диаграмм классов. Эти подъязыки (спецификации) называются **метамоделями**. В терминах UML концептуальная схема называется **моделью**. Модель может быть представлена из метамоделей.  
UML позволяет моделировать разные виды систем: чисто программные, чисто аппаратные, программно-аппаратные, смешанные (включающие деятельность людей) и т.д.

***Диаграмма классов (в терминологии UML)*** - это диаграмма, на которой показан набор классов (и некоторых других сущностей, не имеющих явного отношения к проектированию БД), а также связей между этими классами. Диаграмма классов может включать комментарии и ограничения.  

Как и в модели ER-диаграмм, в UML для родового обозначения связей используется термин «связь».
Для диаграмм классов UML могут задаваться ограничения на естественном языке или же на языке объектных ограничений OCL (Object Constraints Language).

***Класс*** - это именованное описание совокупности объектов с общими атрибутами, операциями, связями и семантикой. 

***Атрибут класса*** - это именованное свойство класса, описывающее множество значений, которые могут принимать экземпляры этого свойства. Множество всех атрибутов класса описывает структуру этого класса. 

Класс может иметь любое число атрибутов (в том числе ноль). Свойство, выражаемое атрибутом, является свойством моделируемой сущности, общим для всех объектов данного класса, т.е. атрибут является абстракцией состояния объекта.

***Операция класса*** - это именованная услуга, которую можно запросить у любого объекта этого класса. ***Операция*** – это то, что можно делать с объектом. Класс может содержать любое число операций (в частности, ни одной). Набор операций класса является общим для всех объектов данного класса.

В диаграмме классов могут участвовать связи трёх категорий:
  -зависимость (dependency)
  -обобщение (generalization)
  -ассоциация (association)
  
***Зависимость*** - это связь, показывающая, что изменение описании одного класса может повлиять на поведение другого класса, использующего первый класс. Как правило зависимость отражает тот факт, что в сигнатуре операции одного класса параметром является объект другого класса. 

***Обобщение*** - это связь между суперклассом (родителем) и подклассом (потомком). Обобщения иногда называют связями «is a», имея в виду, что класс-потомок является частным случаем класса-предка. 

***Ассоциация*** - это структурная связь, показывающая, что объекты одного класса некоторым образом связаны с объектами другого или того же самого класса. В ассоциации могут связываться два класса, и тогда она называется бинарной. Но допускается  также создание ассоциаций, связывающих сразу n классов (они называются n-арными ассоциациями).

## 5. Обработка запросов. Преобразование SQL-выражение во внутреннее представление СУБД

Основные шаги обработки запросов:
  1. Парсинг и трансляция
  2. Оптимизация
  3. Вычисление

**Парсинг**:
  -Осуществляется трансляция запроса в его внутреннюю форму. Затем осуществляется трансляция в реляционную алгебру.
  -Парсер осуществляет проверку синтаксиса и проверку отношений
  
**Вычисление**:
  -Механизм выполнения запросов принимает на вход план запросов, выполняет данный план, и возвращает ответ для запроса.

**Оптимизация**:
  -Из всех эквивалентных планов выполнения выбирается с меньшей стоимостью. Стоимость вычисляется с использованием статистической информации из каталога базы данных. 


## 6. Меры стоимости запросов. Вычисление стоимости операций

Многие факторы участвуют при оценке времени:
  -Доступ к диску, CPU, и сетевые коммуникации
  
Стоимость может быть вычислена на основе
  -времени ответа, т.е. общее время ответа на запросы
  -общее потребление ресурсов
  
Будем рассматривать метрику по потреблению ресурсов
  -Время ответа сложнее вычислить, уменьшение потребления ресурсов – хорошая метрика в общей (shared) БД
  
  
Мы игнорируем стоимость CPU для простоты
  -Реальные системы используют стоимость CPU для оценки
  -Стоимость сети рассматривается для параллельных систем
  
Опишем, как вычислить стоимость для каждой операции (Стоимость записи на диск игнорируем для простоты):
1. Стоимость доступа на диск может быть рассчитана как:
  -Число поисков (среднее время поиска)
  -Число блоков чтения(среднее время чтения блока)
  -Число блоков записи(среднее время записи блока)
   
2. Для простоты учитываем **число трансфера блока с диска и число поисков** как меры стоимости
  -t<sub>T</sub> - время трансфера для одного блока (предполагаем, что стоимость записи соответствует стоимости чтения)
  -t<sub>S</sub> - время для одного поиска

3. t<sub>T</sub> и t<sub>S</sub> зависят от того, где хранятся данные. с 4 КВ блоками:
  -HDD: t<sub>S</sub> = 4 msec и t<sub>T</sub> = 0.1 msec
  -SSD: t<sub>S</sub> = 20-90 microsec и t<sub>T</sub> = 2-10 microsec для 4 КВ

**Стоимость для b трансферов блоков и S поисков:**
$$b * t_T + S * t_S$$


## 7.	Меры стоимости запросов. Оценка операций соединения.



  







